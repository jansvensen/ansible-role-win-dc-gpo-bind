---
  - name: Make sure logging directory exists
    ansible.windows.win_file:
      path: '{{ directory_logging }}'
      state: directory

  - name: Bind GPO to OU=Objects,DC=dt,DC=presales
    script: files/gpo-bind.ps1
    args:
      creates: '{{ directory_logging}}gpo-bind.txt'
    environment:
      target: "OU=Objects,DC=dt,DC=presales"
      gpos: '"GPO_C_IPv6","GPO_C_PowerSettings","GPO_U_Optics_Wallpaper","GPO_U_Optics_User"'
      domain: '{{ domain_dnsname }}'

  - name: Bind GPO to OU=Computer,OU=Objects,DC=dt,DC=presales
    script: files/gpo-bind.ps1
    args:
      creates: '{{ directory_logging}}gpo-bind.txt'
    environment:
      target: "OU=Computer,OU=Objects,DC=dt,DC=presales"
      gpos: '"GPO_C_DisableServerManagerOnStartup","GPO_C_LoopbackProcessing","GPO_C_NewsAndInterests","GPO_C_deviceTRUST_Geolocation_Google","GPO_C_RegionSettings","GPO_C_deviceTRUST_Basic","GPO_C_deviceTRUST_Demo_Demobox"'
      domain: '{{ domain_dnsname }}'